<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>CORS - TS Ingress Controller</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "CORS";
    var mkdocs_page_input_path = "cors.md";
    var mkdocs_page_url = "/cors/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> TS Ingress Controller</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Installation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../source/">Installing from source</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../docker/">Using the Docker Image</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../classes/">Using multiple Ingress controllers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../config/">Configuration</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Usage</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../annotations/">Annotations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../caching/">Caching</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../auth/">Authentication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../external/">External proxying</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tls/">TLS</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">CORS</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#configuring-cross-origing-resource-sharing">Configuring Cross-Origing Resource Sharing</a></li>
                
                    <li><a class="toctree-l4" href="#cors-configuration">CORS configuration</a></li>
                
                    <li><a class="toctree-l4" href="#advanced-configuration">Advanced configuration</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../compression/">Compression</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../serverpush/">Server Push</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">TS Ingress Controller</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Usage &raquo;</li>
        
      
    
    <li>CORS</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/torchbox/k8s-ts-ingress" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="configuring-cross-origing-resource-sharing">Configuring Cross-Origing Resource Sharing</h1>
<p>CORS is a method to permit cross-origin HTTP requests in JavaScript, i.e.
requests made by JS running on one domain to a page on a different domain.
This is usually disallowed for security reasons (it could allow one page to
send requests using the user's credentials to another page); CORS provides a
way to safely permit such requests.</p>
<p>For more information on CORS, see the documentation on the
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">Mozilla Developer Network</a>.</p>
<p>There are two ways to configure CORS: either your application can send CORS
headers itself, or you can configure the Ingress resource to do so for you.
If your application is handling CORS itself, you do not need any of the
configuration described here.</p>
<h2 id="cors-configuration">CORS configuration</h2>
<p>To enable cross-origin requests from any domain, set the
<code>ingress.kubernetes.io/enable-cors</code> annotation on the Ingress resource:</p>
<pre><code class="yaml">metadata:
  annotations:
    ingress.kubernetes.io/enable-cors: &quot;true&quot;
</code></pre>

<p>This will allow requests from any origin, without credentials, for the CORS
basic methods (GET, POST and HEAD).  This is generally sufficient to permit
cross-origin loading of resources (such as fonts) without compromising the
security of the application.</p>
<p>If you want to restrict requests to a set of origins, you can set the
<code>cors-origins</code> annotations:</p>
<pre><code class="yaml">  annotations:
    ingress.kubernetes.io/enable-cors: &quot;true&quot;
    ingress.kubernetes.io/cors-origins: &quot;http://example.com http://example.org&quot;
</code></pre>

<p>This would allow cross-origin requests from the two listed origins, but no
others.</p>
<p>If you want to permit requests with credentials, you can set the <code>cors-credentials</code>
annotation:</p>
<pre><code class="yaml">  annotations:
    ingress.kubernetes.io/enable-cors: &quot;true&quot;
    ingress.kubernetes.io/cors-origins: &quot;http://example.com http://example.org&quot;
    ingress.kubernetes.io/cors-credentials: &quot;true&quot;
</code></pre>

<p>This will permit requests with credentials (such as Cookie headers); be very
careful with this, as it essentially allows any of the listed origins to make
requests using the user's credentials.  If you use <code>cors-credentials</code>, you must
also set <code>cors-origins</code>; you cannot allow requests with credentials from any
origin.</p>
<p>By default, requests are allowed for any the CORS simple methods; that is,
<code>GET</code>, <code>POST</code> or <code>HEAD</code>.  These are the methods which JavaScript can already
use without CORS.  To permit additional methods, set the <code>cors-methods</code>
annotation:</p>
<pre><code class="yaml">  annotations:
    ingress.kubernetes.io/enable-cors: &quot;true&quot;
    ingress.kubernetes.io/cors-origins: &quot;http://example.com&quot;
    ingress.kubernetes.io/cors-credentials: &quot;true&quot;
    ingress.kubernetes.io/cors-methods: &quot;PUT, DELETE&quot;
</code></pre>

<p>You do not need to list the simple methods in <code>cors-methods</code>, as they are always
permitted.</p>
<p>By default, the browser will preflight the request with a separate OPTIONS
request every time it needs to make an access control decision, which adds
a significant overhead to the request processing time.  If you expect each
client to make several CORS-authenticated requests, you can set the <code>cors-max-age</code>
annotation to the number of seconds the browser is permitted to cache the
preflight result:</p>
<pre><code class="yaml">  annotations:
    ingress.kubernetes.io/enable-cors: &quot;true&quot;
    ingress.kubernetes.io/cors-origins: &quot;http://example.com&quot;
    ingress.kubernetes.io/cors-credentials: &quot;true&quot;
    ingress.kubernetes.io/cors-max-age: &quot;3600&quot;
</code></pre>

<p>By default, the browser will only permit the CORS simple headers in the
request: <code>Accept</code>, <code>Accept-Language</code>, <code>Content-Language</code>, or <code>Content-Type</code> (if
the value is <code>application/x-www-form-urlencoded</code>, <code>multipath/form-data</code> or
<code>text/plain</code>).  To allow additional request headers, set the
<code>ingress.kubernetes.io/cors-headers</code> annotation:</p>
<pre><code class="yaml">  annotations:
    ingress.kubernetes.io/enable-cors: &quot;true&quot;
    ingress.kubernetes.io/cors-origins: &quot;http://example.com&quot;
    ingress.kubernetes.io/cors-credentials: &quot;true&quot;
    ingress.kubernetes.io/cors-headers: &quot;X-CustomHeader&quot;
</code></pre>

<h2 id="advanced-configuration">Advanced configuration</h2>
<p>If you want to allow cross-origin requests from a specific set of domains, or
you want to control the request methods permitted or whether credentials should
be sent, do not use <code>enable-cors</code>; instead, set the
<code>ingress.kubernetes.io/access-control-allow-origin</code> annotation:</p>
<pre><code class="yaml">ingress.kubernetes.io/access-control-allow-origin: &quot;*&quot;
</code></pre>

<p>or:</p>
<pre><code class="yaml">ingress.kubernetes.io/access-control-allow-origin: &quot;https://mydomain.com https://myothersite.com&quot;
</code></pre>

<p>The value should be either <code>"*"</code> (meaning all origins) or a whitespace-delimited
list of origins.</p>
<p>You can use the following set of annotations to configure other CORS headers
in the response:</p>
<ul>
<li><code>ingress.kubernetes.io/access-control-allow-credentials</code></li>
<li><code>ingress.kubernetes.io/access-control-allow-methods</code></li>
<li>`ingress.kubernetes.io/access-control-allow-headers</li>
<li><code>ingress.kubernetes.io/access-control-max-age</code></li>
</ul>
<p>There is no default for these values, so you will likely want to set all of
them.</p>
<p>Do not set <code>ingress.kubernetes.io/enable-cors</code> at the same time as any of the
other CORS-related annotations; behaviour in that case is undefined.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../compression/" class="btn btn-neutral float-right" title="Compression">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../tls/" class="btn btn-neutral" title="TLS"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright (c) 2016-2017 Torchbox Ltd.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/torchbox/k8s-ts-ingress" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../tls/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../compression/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
